<!DOCTYPE html>

<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">

  <meta name="description" content="kpa1onの博客">


<link rel="alternate" href="/atom.xml" title="kpa1on&#39;s Blog" type="application/atom+xml">
<meta name="theme-color" content="#a1d0f6">
<title>远程调试 - kpa1on&#39;s Blog</title>
<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
<link rel="shortcut icon" href="/favicon.png">

<link rel="stylesheet" href="/css/style.css">

<nav class="main-nav">
	
	    <a href="/">← 主页</a>
	
	
	    <a href="/">home</a>
	
	    <a href="/about">about</a>
	
	    <a href="/archives">archives</a>
	
	<a class="cta" href="/atom.xml" data-no-instant>订阅</a>
</nav>

<section id="wrapper">
    <article class="post">
    <header>
        
            <h1>远程调试</h1>
        
        <h2 class="headline">Mar 16 2022
        
        </h2>
    </header>
</article>
<section id="post-body"><meta name="referrer" content="no-referrer"/>

<h2 id="对Jar包进行远程调试"><a href="#对Jar包进行远程调试" class="headerlink" title="对Jar包进行远程调试"></a>对Jar包进行远程调试</h2><p>这里以冰蝎做示例，使用IDEA创建一个Java项目，并创建一个lib文件夹将Jar包和它的db数据库放入，再选中lib文件夹后，右键选择“add as library”，将lib文件夹添加进项目依赖，成功添加后可以看到Jar包中反编译后的源代码。</p>
<span id="more"></span>

<p><img src="https://img2022.cnblogs.com/blog/1993367/202203/1993367-20220316105447193-2138419681.png" alt="image-20220316105447105"></p>
<p>通过右上角的“Add Configurations”，并单击“+”来添加一个“Remote”，默认配置即可，单击“apply”提交保存。其中“-agentlib:jdwp&#x3D;transport&#x3D;dt_socket,server&#x3D;y,suspend&#x3D;n,address&#x3D;5005”将作为运行时的启动参数。</p>
<p><img src="https://img2022.cnblogs.com/blog/1993367/202203/1993367-20220316105651451-1732887489.png" alt="image-20220316105652338"></p>
<p>将“ -agentlib:jdwp&#x3D;transport&#x3D;dt_socket,server&#x3D;y,suspend&#x3D;y,address&#x3D;5005”作为启动参数运行冰蝎的Jar包，suspend表示是否暂停程序等待调试器的连接，“y”表示暂停，“n”表示不暂停。建议选择暂停，避免程序执行过快导致一些断点无法拦截程序。</p>
<p><img src="https://img2022.cnblogs.com/blog/1993367/202203/1993367-20220316105919953-1313789309.png" alt="image-20220316105920262"></p>
<p>设置好断点，单击右上角的Debug按钮，即可发现程序在断点处暂停，然后可以进行逐步的调试了</p>
<p><img src="https://img2022.cnblogs.com/blog/1993367/202203/1993367-20220316110143684-113134102.png" alt="image-20220316110144268"></p>
<h2 id="对Weblogic进行远程调试"><a href="#对Weblogic进行远程调试" class="headerlink" title="对Weblogic进行远程调试"></a>对Weblogic进行远程调试</h2><p>进入&#x2F;weblogic&#x2F;CVE-2017-10271文件夹，修改其中的docker-compose.yml，将8453端口打开，这个端口是用来调试的</p>
<p><img src="https://img2022.cnblogs.com/blog/1993367/202203/1993367-20220316111611425-940242255.png" alt="image-20220316111612357"></p>
<p>使用<code>docker-compose up -d</code> 命令编译镜像并启动容器，如下容器启动成功，开始8453端口映射到本地</p>
<p><img src="https://img2022.cnblogs.com/blog/1993367/202203/1993367-20220316112021582-176155912.png" alt="image-20220316112022492"></p>
<p>使用<code>docker exec -it 25 /bin/bash</code>命令进入容器，使用vim修改~&#x2F;Oracle&#x2F;Middleware&#x2F;user_projects&#x2F;domains&#x2F;base_domain&#x2F;bin</p>
<p><img src="https://img2022.cnblogs.com/blog/1993367/202203/1993367-20220316112500955-289297251.png" alt="image-20220316112501671"></p>
<p>使用<code>docker restart</code>命令重启容器，再进入容器，将&#x2F;root&#x2F;Oracle&#x2F;Middleware&#x2F;下的modules和wlserver_10.3文件夹使用zip命令压缩成zip压缩包。容器中是一个简易的Linux系统，需要执行<code>apt-get install zip</code>来安装zip压缩功能。Windows命令行对路径长度有限制，如果直接使用dokcer的cp指令，就会在复制一些长文件名的文件时报错，因此这一步的目的就是打包成压缩文件再进行复制，使用<code>docker cp</code>命令将zip文件复制到本机下</p>
<p><img src="https://img2022.cnblogs.com/blog/1993367/202203/1993367-20220316114731945-619105757.png" alt="image-20220316114732752"></p>
<p>将该文件夹移动至一个项目文件中，选中wlserver_10.3&#x2F;server&#x2F;lib文件和modules文件右键单击，选择“add as library”添加库</p>
<p><img src="https://img2022.cnblogs.com/blog/1993367/202203/1993367-20220316121504585-664894600.png" alt="image-20220316121505388"></p>
<p>配置调试器，和上面的jar包一样，端口换成8453就行了</p>
<p><img src="https://img2022.cnblogs.com/blog/1993367/202203/1993367-20220316121117278-1364284906.png" alt="image-20220316121117895"></p>
<h2 id="对Tomcat进行远程调试"><a href="#对Tomcat进行远程调试" class="headerlink" title="对Tomcat进行远程调试"></a>对Tomcat进行远程调试</h2><p>同样进入Vulhub中CVE-2017-12615漏洞环境所在的文件夹，修改docker-compose.yml文件，将5005端口开启，进入容器中，在&#x2F;usr&#x2F;local&#x2F;tomcat&#x2F;bin&#x2F;catalina.sh插入命令<code>JAVA_OPTS=&quot;-agentlib:jdwp=transport=dt_socket,server=y,suspend=y,address=5005&quot;</code>，然后重启docker；下一步就是导出dokcer里面的lib，<code>docker cp 25:/usr/local/tomcat/lib ./</code>，并把lib设置为库，后面配置调试器，和上面的jar包一样。</p>
</section>
    
        
        <h2 class="footline">
            <a href="/tags/调试/#调试">调试</a>
        </h2>
    

    <footer id="post-meta" class="clearfix">
        <a href="/about">
        <img class="avatar" src="/images/avatar.png">
        <div>
            <span class="dark">kpa1on&#39;s Blog</span>
            <span>keep passion！</span>
        </div>
        </a>
        <section id="sharing">
            <a title="Share to Twitter" class="twitter" target="_blank" rel="noopener" href="https://twitter.com/intent/tweet?text=https://kpa1on.github.io/2022/03/16/%E8%BF%9C%E7%A8%8B%E8%B0%83%E8%AF%95/ - 远程调试 @"><span class="icon-twitter">tweet</span></a>
            <a title="Share to Facebook" class="facebook" href="#" onclick="
                window.open(
                  'https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),
                  'facebook-share-dialog',
                  'width=626,height=436');
                return false;"><span class="icon-facebook-sign">Share</span>
            </a>
        </section>
    </footer>


  <section id="comment">
    <button class="btn" id="loadcmts" onclick="cmts.load();">加载评论</button>
    <div id="gitment"></div>
    <script src='/js/gitment.browser.js'></script>
    <link rel="stylesheet" href=''>
    <script>
      var cmts={
        load:function cmts(){
          var gitment = new Gitment({
          
            id: "远程调试",
          
            owner: "",
            repo: "",
            oauth: {
              client_id: "",
              client_secret: "",
            },
          })
          gitment.render('gitment');
          var loadcmt = document.getElementById("loadcmts");
          var imyourfather = loadcmt.parentNode;
          imyourfather.removeChild(loadcmts)
        }
      }
    </script>
  </section>


	<footer id="footer">
	<div id="social">
		<p class="small">©  kpa1on| Powered by Hexo & 
			<a target="_blank" rel="noopener" href="https://github.com/F0r3at/Lights"> Lights</a>
		</p>
	</div>
</footer>

</section>

	<script src="//cdnjs.loli.net/ajax/libs/instantclick/3.0.1/instantclick.min.js" data-no-instant></script>
	<script data-no-instant>
		
		InstantClick.init('mousedown');
	</script>




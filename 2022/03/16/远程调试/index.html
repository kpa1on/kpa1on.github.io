<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    
        <title>远程调试 | Mint Forge</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <link rel='shortcut icon' href="/favicon.ico">
    
<link rel="stylesheet" href="/css/index.css">

    
<link rel="stylesheet" href="/css/plugins/highlight/dark.css">

    
<link rel="stylesheet" href="/css/plugins/iconfont/iconfont.css">

<meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="kpa1on's Blog" type="application/atom+xml">
</head>
<body>
    <div class="navbar-container">
    <div class="navbar">
        <ul>
            <li><a href="/">MINT FORGE</a></li>
            <li><a href="/">首页</a></li>
            <li><a href='/categories'>分类</a></li>
            <li><a href="/tags">标签</a></li>
            <li><a href="/about">关于</a></li>
        </ul>
    </div>
</div>
    <div class="all-container">
        <div class="article-container">
    <h2 class="title">远程调试</h2>
    <span class="info">2022年3月16日</span>
    
    
        <div class="toc">
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9Jar%E5%8C%85%E8%BF%9B%E8%A1%8C%E8%BF%9C%E7%A8%8B%E8%B0%83%E8%AF%95"><span class="toc-number">1.</span> <span class="toc-text">对Jar包进行远程调试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9Weblogic%E8%BF%9B%E8%A1%8C%E8%BF%9C%E7%A8%8B%E8%B0%83%E8%AF%95"><span class="toc-number">2.</span> <span class="toc-text">对Weblogic进行远程调试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9Tomcat%E8%BF%9B%E8%A1%8C%E8%BF%9C%E7%A8%8B%E8%B0%83%E8%AF%95"><span class="toc-number">3.</span> <span class="toc-text">对Tomcat进行远程调试</span></a></li></ol>
        </div>
    

    <div class="content"><meta name="referrer" content="no-referrer"/>

<h2 id="对Jar包进行远程调试"><a href="#对Jar包进行远程调试" class="headerlink" title="对Jar包进行远程调试"></a>对Jar包进行远程调试</h2><p>这里以冰蝎做示例，使用IDEA创建一个Java项目，并创建一个lib文件夹将Jar包和它的db数据库放入，再选中lib文件夹后，右键选择“add as library”，将lib文件夹添加进项目依赖，成功添加后可以看到Jar包中反编译后的源代码。</p>
<span id="more"></span>

<p><img src="https://img2022.cnblogs.com/blog/1993367/202203/1993367-20220316105447193-2138419681.png" alt="image-20220316105447105"></p>
<p>通过右上角的“Add Configurations”，并单击“+”来添加一个“Remote”，默认配置即可，单击“apply”提交保存。其中“-agentlib:jdwp&#x3D;transport&#x3D;dt_socket,server&#x3D;y,suspend&#x3D;n,address&#x3D;5005”将作为运行时的启动参数。</p>
<p><img src="https://img2022.cnblogs.com/blog/1993367/202203/1993367-20220316105651451-1732887489.png" alt="image-20220316105652338"></p>
<p>将“ -agentlib:jdwp&#x3D;transport&#x3D;dt_socket,server&#x3D;y,suspend&#x3D;y,address&#x3D;5005”作为启动参数运行冰蝎的Jar包，suspend表示是否暂停程序等待调试器的连接，“y”表示暂停，“n”表示不暂停。建议选择暂停，避免程序执行过快导致一些断点无法拦截程序。</p>
<p><img src="https://img2022.cnblogs.com/blog/1993367/202203/1993367-20220316105919953-1313789309.png" alt="image-20220316105920262"></p>
<p>设置好断点，单击右上角的Debug按钮，即可发现程序在断点处暂停，然后可以进行逐步的调试了</p>
<p><img src="https://img2022.cnblogs.com/blog/1993367/202203/1993367-20220316110143684-113134102.png" alt="image-20220316110144268"></p>
<h2 id="对Weblogic进行远程调试"><a href="#对Weblogic进行远程调试" class="headerlink" title="对Weblogic进行远程调试"></a>对Weblogic进行远程调试</h2><p>进入&#x2F;weblogic&#x2F;CVE-2017-10271文件夹，修改其中的docker-compose.yml，将8453端口打开，这个端口是用来调试的</p>
<p><img src="https://img2022.cnblogs.com/blog/1993367/202203/1993367-20220316111611425-940242255.png" alt="image-20220316111612357"></p>
<p>使用<code>docker-compose up -d</code> 命令编译镜像并启动容器，如下容器启动成功，开始8453端口映射到本地</p>
<p><img src="https://img2022.cnblogs.com/blog/1993367/202203/1993367-20220316112021582-176155912.png" alt="image-20220316112022492"></p>
<p>使用<code>docker exec -it 25 /bin/bash</code>命令进入容器，使用vim修改~&#x2F;Oracle&#x2F;Middleware&#x2F;user_projects&#x2F;domains&#x2F;base_domain&#x2F;bin</p>
<p><img src="https://img2022.cnblogs.com/blog/1993367/202203/1993367-20220316112500955-289297251.png" alt="image-20220316112501671"></p>
<p>使用<code>docker restart</code>命令重启容器，再进入容器，将&#x2F;root&#x2F;Oracle&#x2F;Middleware&#x2F;下的modules和wlserver_10.3文件夹使用zip命令压缩成zip压缩包。容器中是一个简易的Linux系统，需要执行<code>apt-get install zip</code>来安装zip压缩功能。Windows命令行对路径长度有限制，如果直接使用dokcer的cp指令，就会在复制一些长文件名的文件时报错，因此这一步的目的就是打包成压缩文件再进行复制，使用<code>docker cp</code>命令将zip文件复制到本机下</p>
<p><img src="https://img2022.cnblogs.com/blog/1993367/202203/1993367-20220316114731945-619105757.png" alt="image-20220316114732752"></p>
<p>将该文件夹移动至一个项目文件中，选中wlserver_10.3&#x2F;server&#x2F;lib文件和modules文件右键单击，选择“add as library”添加库</p>
<p><img src="https://img2022.cnblogs.com/blog/1993367/202203/1993367-20220316121504585-664894600.png" alt="image-20220316121505388"></p>
<p>配置调试器，和上面的jar包一样，端口换成8453就行了</p>
<p><img src="https://img2022.cnblogs.com/blog/1993367/202203/1993367-20220316121117278-1364284906.png" alt="image-20220316121117895"></p>
<h2 id="对Tomcat进行远程调试"><a href="#对Tomcat进行远程调试" class="headerlink" title="对Tomcat进行远程调试"></a>对Tomcat进行远程调试</h2><p>同样进入Vulhub中CVE-2017-12615漏洞环境所在的文件夹，修改docker-compose.yml文件，将5005端口开启，进入容器中，在&#x2F;usr&#x2F;local&#x2F;tomcat&#x2F;bin&#x2F;catalina.sh插入命令<code>JAVA_OPTS=&quot;-agentlib:jdwp=transport=dt_socket,server=y,suspend=y,address=5005&quot;</code>，然后重启docker；下一步就是导出dokcer里面的lib，<code>docker cp 25:/usr/local/tomcat/lib ./</code>，并把lib设置为库，后面配置调试器，和上面的jar包一样。</p>
</div>
    <hr>
    <div class="tags"></div>
</div>
<div class="paging">
    
    
        <a id="prev" href="/2022/03/17/Java%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6%E5%AD%A6%E4%B9%A0/">上一篇</a>
    
    
        <a id="next" href="/2022/03/15/Docker%E5%AE%B9%E5%99%A8%E7%9A%84%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/">下一篇</a>
    
</div>
<div class="footer">
    <p><a href="/about/">转载前请联系作者</a></p>
</div>

<script src="/js/highlight.pack.js"></script>

</script>
<script>
	hljs.initHighlightingOnLoad();
</script>

<script src="/js/iconfont.js"></script>

<style>
    .icon {
      width: 1rem;
      height: 1rem;
      vertical-align: -0.15em;
      fill: currentColor;
      overflow: hidden;
    }
</style>
    
    </div>
    <div class='rights'>
	<p>©<span id='years'></span> Mint Forge. All Rights Reserved.</p>
</div>
<script type="text/javascript">
	var today = new Date()
	var years = today.getFullYear()
	document.getElementById('years').innerHTML=years
</script>
    
<script src="/js/iconfont.js"></script>

<style>
    .icon {
      width: 1rem;
      height: 1rem;
      vertical-align: -0.15em;
      fill: currentColor;
      overflow: hidden;
    }
</style>
    
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false});</script></body>
</html>